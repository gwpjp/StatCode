df520 <- read.csv("../BookData/Chapter\ 5\ Examples/ex5_20.txt", col.names = c("Size","Cannibalism"))
setwd("~/Documents/Coding/StatCode/Code")
df520 <- read.csv("../BookData/Chapter\ 5\ Examples/ex5_20.txt", col.names = c("Size","Cannibalism"))
ggplot(df520,aes(x=Size,y=Cannibalism)) + geom_point(color="orange",alpha = .4) +
labs(x = "Size Difference (mm)", y = "Cannibalism", title = "Example 5.20") +
theme(plot.title = element_text(hjust = 0.5))
library(ggplot2)
library(scales)
ggplot(df520,aes(x=Size,y=Cannibalism)) + geom_point(color="orange",alpha = .4) +
labs(x = "Size Difference (mm)", y = "Cannibalism", title = "Example 5.20") +
theme(plot.title = element_text(hjust = 0.5))
g520 <- glm(Cannibalism ~ Size,family = binomial,data = df520)
summary(g520)
val520 <- coefficients(g520)
ggplot(df520,aes(x=Size,y=Cannibalism)) + geom_point(color="orange",alpha = .4) +
labs(x = "Size Difference (mm)", y = "Cannibalism", title = "Example 5.20") +
theme(plot.title = element_text(hjust = 0.5)) +
stat_function(fun = function(x){exp(val520[1] + val520[2]*x)/(1 + exp(val520[1] + val520[2]*x))},color = "blue")
t520 <- as.data.frame(table(df520)[,"1"]/(table(df520)[,"0"] + table(df520)[,"1"]))
colnames(t520) <- c("CannRate")
t520$Size <- as.numeric(rownames(t520))
t520$Total <- as.data.frame((table(df520)[,"0"] + table(df520)[,"1"]))
rownames(t520) <- NULL
colnames(t520[,3]) <- "Total"
t520
#Note: This tranformation will fail because the Cannibalism rate can be 0.
ggplot(t520,aes(x=Size,y=log(CannRate/(1-log(CannRate))))) + geom_point(color = "orange")
df522 <- read.csv("../BookData/Chapter\ 5\ Examples/ex5_22.txt", col.names = c("Rain","Call"))
ggplot(df522,aes(x=Rain,y=Call)) + geom_point(color="orange") +
labs(x = "Rainfall (mm)", y = "Call Rate", title = "Example 5.22") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(df522,aes(x=Rain,y=log(Call/(1-Call)))) + geom_point(color="orange") +
labs(x = "Rainfall (mm)", y = "(Call Rate)'", title = "Example 5.22") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method = "lm",se = FALSE)
l522 <- lm(log(Call/(1-Call)) ~ Rain,df522)
summary(l522)
val522 <- coefficients(l522)
ggplot(df522,aes(x=Rain,y=Call)) + geom_point(color="orange") +
labs(x = "Rainfall (mm)", y = "Call Rate", title = "Example 5.22") +
theme(plot.title = element_text(hjust = 0.5)) +
stat_function(fun = function(x){exp(val522[1] + val522[2]*x)/(1+exp(val522[1] + val522[2]*x))},color = "blue",width = 1.5 )
summary(l522)
val522 <- coefficients(l522)
val522
